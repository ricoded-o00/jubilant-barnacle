<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Home Lab Architecture Plan</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <!-- 
        Palette: Cyber Professional
        Background: #f0f4f8 (Alice Blue - Light contrast)
        Primary Card: #ffffff
        Text Main: #1e293b (Slate 800)
        Text Muted: #64748b (Slate 500)
        Accent Blue: #3b82f6 (Blue 500)
        Accent Green: #10b981 (Emerald 500)
        Accent Dark: #0f172a (Slate 900)
    -->

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f4f8;
            color: #1e293b;
        }
        
        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom CSS Diagram Styles (No SVG/Mermaid) */
        .network-node {
            background-color: white;
            border: 2px solid #3b82f6;
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            position: relative;
            transition: transform 0.2s;
        }
        .network-node:hover {
            transform: translateY(-2px);
            border-color: #10b981;
        }
        .connector-vertical {
            width: 2px;
            background-color: #94a3b8;
            margin: 0 auto;
        }
        .connector-horizontal {
            height: 2px;
            background-color: #94a3b8;
            margin: 0 auto;
        }

        /* Timeline Styles */
        .timeline-item {
            position: relative;
            padding-left: 2rem;
            border-left: 2px solid #3b82f6;
            margin-bottom: 2rem;
        }
        .timeline-dot {
            position: absolute;
            left: -9px;
            top: 0;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: #10b981;
            border: 2px solid white;
        }
    </style>
    <!-- 
        Source Material Analysis:
        Topic: Virtualized Home Lab (VMware + Docker + pfSense + Splunk).
        Goal: Plan and Documentation.
        Narrative: Architecture -> Segmentation -> Services -> Security/Logging.
        NO SVG. NO MERMAID. Chart.js used for data. CSS used for diagrams.
    -->
</head>
<body class="p-4 md:p-8">

    <!-- Header -->
    <header class="max-w-6xl mx-auto mb-12 text-center">
        <div class="inline-block bg-blue-600 text-white px-4 py-1 rounded-full text-sm font-bold tracking-wide mb-4">CYBERSECURITY ADVISOR PLAN</div>
        <h1 class="text-4xl md:text-5xl font-bold text-slate-900 mb-4">Virtualized Home Lab Architecture</h1>
        <p class="text-lg text-slate-600 max-w-3xl mx-auto">
            A comprehensive technical blueprint for a secure, segmented, and monitored home laboratory environment utilizing VMware ESXi, Docker, pfSense, and Splunk.
        </p>
    </header>

    <!-- Main Grid Layout -->
    <main class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8">

        <!-- Section 1: Strategic Objectives (Text Only) -->
        <section class="md:col-span-2 bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500">
            <h2 class="text-2xl font-bold mb-4 text-slate-800">1. Strategic Objectives & Scope</h2>
            <p class="mb-4 text-slate-600">
                This architecture is designed to minimize hardware footprint while maximizing isolation and visibility. By leveraging <strong>VMware ESXi</strong> as the bare-metal hypervisor, we virtualize the network core (pfSense) and the application layer (Docker Host). The primary goal is to create a <strong>Zero-Trust-Lite</strong> environment where services are isolated by function, and all traffic is inspected and logged.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                <div class="bg-slate-50 p-4 rounded-md">
                    <h3 class="font-bold text-blue-600">Segregation</h3>
                    <p class="text-sm">VLANs isolate IoT, Guest, and Lab traffic from the Management plane.</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-md">
                    <h3 class="font-bold text-blue-600">Containerization</h3>
                    <p class="text-sm">90% of services run as Docker containers for efficiency and rapid teardown.</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-md">
                    <h3 class="font-bold text-blue-600">Visibility</h3>
                    <p class="text-sm">Centralized logging via Splunk captures firewall hits and container logs.</p>
                </div>
            </div>
        </section>

        <!-- Section 2: Network Topology (CSS Diagram) -->
        <section class="md:col-span-2 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-bold mb-2 text-slate-800">2. Logical Network Topology</h2>
            <p class="text-sm text-slate-500 mb-8">This diagram illustrates the virtual switching path. Traffic flows from the physical WAN into the virtualized pfSense instance, which then routes to specific VLAN port groups.</p>
            
            <!-- CSS/HTML Diagram Construction -->
            <div class="flex flex-col items-center w-full max-w-3xl mx-auto">
                
                <!-- Tier 1: Physical Ingress -->
                <div class="network-node w-48 border-slate-400 bg-slate-100">
                    <span class="font-bold block">ISP / Modem</span>
                    <span class="text-xs text-slate-500">Physical Ingress</span>
                </div>
                <div class="connector-vertical h-8"></div>
                
                <!-- Tier 2: Hypervisor Physical NIC -->
                <div class="network-node w-48 border-slate-800 bg-slate-800 text-white">
                    <span class="font-bold block">ESXi Host (NIC 0)</span>
                    <span class="text-xs text-slate-400">Physical Hardware</span>
                </div>
                <div class="connector-vertical h-8"></div>

                <!-- Tier 3: Virtual WAN Switch -->
                <div class="network-node w-48 border-emerald-500">
                    <span class="font-bold block">vSwitch0 (WAN)</span>
                    <span class="text-xs text-slate-500">Virtual Switch</span>
                </div>
                <div class="connector-vertical h-8"></div>

                <!-- Tier 4: pfSense VM -->
                <div class="network-node w-64 bg-blue-50 border-blue-600 shadow-lg">
                    <span class="font-bold text-blue-800 block text-lg">pfSense VM</span>
                    <span class="text-xs text-blue-600">Firewall / Router / DHCP / DNS</span>
                </div>
                <div class="connector-vertical h-8"></div>

                <!-- Tier 5: Virtual LAN Switch -->
                <div class="network-node w-48 border-emerald-500">
                    <span class="font-bold block">vSwitch1 (Trunk)</span>
                    <span class="text-xs text-slate-500">Internal Traffic</span>
                </div>
                <div class="connector-vertical h-8"></div>

                <!-- Tier 6: Port Groups (Horizontal) -->
                <div class="flex justify-center w-full gap-2 md:gap-4 flex-wrap">
                    <!-- VLAN 10 -->
                    <div class="flex flex-col items-center">
                        <div class="connector-vertical h-4"></div>
                        <div class="network-node w-28 md:w-32 text-sm border-purple-400">
                            <strong>Mgmt VLAN</strong>
                            <br><span class="text-xs">10.0.10.x</span>
                        </div>
                    </div>
                    <!-- VLAN 20 -->
                    <div class="flex flex-col items-center">
                        <div class="connector-vertical h-4"></div>
                        <div class="network-node w-28 md:w-32 text-sm border-orange-400">
                            <strong>Docker VLAN</strong>
                            <br><span class="text-xs">10.0.20.x</span>
                        </div>
                    </div>
                     <!-- VLAN 30 -->
                     <div class="flex flex-col items-center">
                        <div class="connector-vertical h-4"></div>
                        <div class="network-node w-28 md:w-32 text-sm border-red-400">
                            <strong>DMZ VLAN</strong>
                            <br><span class="text-xs">10.0.30.x</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: VLAN Segmentation Plan (Table) -->
        <section class="md:col-span-1 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-bold mb-4 text-slate-800">3. Segmentation Strategy</h2>
            <p class="mb-4 text-slate-600 text-sm">
                Strict segmentation is the primary defense. The <strong>Docker Host</strong> resides in a server VLAN, while management interfaces (ESXi web UI, iDRAC) are restricted to a secured Management VLAN.
            </p>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-slate-600">
                    <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                        <tr>
                            <th scope="col" class="px-3 py-2">ID</th>
                            <th scope="col" class="px-3 py-2">Name</th>
                            <th scope="col" class="px-3 py-2">Purpose</th>
                            <th scope="col" class="px-3 py-2">Access</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="bg-white border-b hover:bg-slate-50">
                            <td class="px-3 py-2 font-bold">10</td>
                            <td class="px-3 py-2">MGMT</td>
                            <td class="px-3 py-2">ESXi, Switch UI</td>
                            <td class="px-3 py-2 text-green-600">Strict</td>
                        </tr>
                        <tr class="bg-white border-b hover:bg-slate-50">
                            <td class="px-3 py-2 font-bold">20</td>
                            <td class="px-3 py-2">SRV-DOCKER</td>
                            <td class="px-3 py-2">Ubuntu Docker Host</td>
                            <td class="px-3 py-2 text-yellow-600">Restricted</td>
                        </tr>
                        <tr class="bg-white border-b hover:bg-slate-50">
                            <td class="px-3 py-2 font-bold">30</td>
                            <td class="px-3 py-2">DMZ</td>
                            <td class="px-3 py-2">Public Services</td>
                            <td class="px-3 py-2 text-red-600">Isolated</td>
                        </tr>
                        <tr class="bg-white border-b hover:bg-slate-50">
                            <td class="px-3 py-2 font-bold">40</td>
                            <td class="px-3 py-2">IoT</td>
                            <td class="px-3 py-2">Cameras, Sensors</td>
                            <td class="px-3 py-2 text-red-600">No Internet</td>
                        </tr>
                        <tr class="bg-white hover:bg-slate-50">
                            <td class="px-3 py-2 font-bold">99</td>
                            <td class="px-3 py-2">USER</td>
                            <td class="px-3 py-2">Daily Driver PC</td>
                            <td class="px-3 py-2 text-blue-600">Standard</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 4: Resource Allocation (Chart.js Doughnut) -->
        <section class="md:col-span-1 bg-white rounded-lg shadow-md p-6 flex flex-col">
            <h2 class="text-2xl font-bold mb-2 text-slate-800">4. Resource Allocation</h2>
            <p class="text-sm text-slate-500 mb-4">
                Comparison of compute resource allocation. By using Docker for services instead of full VMs, we reduce memory overhead by approximately 60%.
            </p>
            <div class="chart-container flex-grow">
                <canvas id="resourceChart"></canvas>
            </div>
            <div class="mt-4 text-xs text-slate-400 text-center">
                *Docker containers share the host kernel, significantly reducing RAM usage compared to dedicated VMs.
            </div>
        </section>

        <!-- Section 5: Implementation Roadmap (CSS Timeline) -->
        <section class="md:col-span-1 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-bold mb-4 text-slate-800">5. Implementation Roadmap</h2>
            <p class="text-sm text-slate-600 mb-6">A phased approach to building the lab ensures connectivity is established before security policies potentially lock you out.</p>
            
            <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="font-bold text-slate-800">Phase 1: Foundation</h3>
                <p class="text-sm text-slate-600">Install ESXi. Deploy pfSense VM. Establish WAN connectivity and basic LAN (VLAN 1 default) routing.</p>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="font-bold text-slate-800">Phase 2: Segmentation</h3>
                <p class="text-sm text-slate-600">Create vSwitch Port Groups (VLAN 10, 20, 30). Configure pfSense Interfaces and DHCP scopes for each VLAN.</p>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="font-bold text-slate-800">Phase 3: Services</h3>
                <p class="text-sm text-slate-600">Deploy Ubuntu Server VM. Install Docker & Portainer. Spin up Nginx Proxy Manager and Pi-hole.</p>
            </div>

            <div class="timeline-item">
                <div class="timeline-dot" style="background-color: #3b82f6;"></div>
                <h3 class="font-bold text-slate-800">Phase 4: Security</h3>
                <p class="text-sm text-slate-600">Create "Deny All" firewall rules between VLANs. Allow only specific ports (DNS:53, HTTPS:443). Install Splunk.</p>
            </div>
        </section>

        <!-- Section 6: Splunk Logging Architecture (Chart.js Bar) -->
        <section class="md:col-span-1 bg-white rounded-lg shadow-md p-6 flex flex-col">
            <h2 class="text-2xl font-bold mb-2 text-slate-800">6. Monitoring & Logs</h2>
            <p class="text-sm text-slate-500 mb-4">
                Splunk acts as the SIEM. We forward logs from pfSense (Syslog) and Docker containers (Splunk Driver) to analyze traffic patterns and blocked requests.
            </p>
            <div class="chart-container flex-grow">
                <canvas id="loggingChart"></canvas>
            </div>
            <div class="mt-4 text-xs text-slate-400 text-center">
                Projected daily log volume (MB) per source.
            </div>
        </section>

        <!-- Section 7: Threat Surface Analysis (Chart.js Radar) -->
        <section class="md:col-span-2 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-bold mb-2 text-slate-800">7. Security Posture Analysis</h2>
            <p class="text-sm text-slate-500 mb-6">
                Visualizing the improvement in security posture when moving from a flat network (Standard Router) to this segmented architecture (pfSense + VLANs).
            </p>
            <div class="chart-container">
                <canvas id="securityRadar"></canvas>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="text-center py-8 text-slate-400 text-sm mt-8">
        <p>Generated by Canvas Infographics for Cybersecurity Advisory</p>
        <p>No SVG or Mermaid.js used. Built with HTML, Tailwind CSS, and Chart.js.</p>
    </footer>

    <!-- JavaScript for Charts -->
    <script>
        // Common defaults
        Chart.defaults.font.family = "'Roboto', sans-serif";
        Chart.defaults.color = '#64748b';

        // Helper: Label Wrapping for Chart.js
        function wrapLabel(label) {
            if (label.length > 16) {
                const words = label.split(' ');
                const lines = [];
                let currentLine = words[0];

                for (let i = 1; i < words.length; i++) {
                    if (currentLine.length + words[i].length + 1 <= 16) {
                        currentLine += ' ' + words[i];
                    } else {
                        lines.push(currentLine);
                        currentLine = words[i];
                    }
                }
                lines.push(currentLine);
                return lines;
            }
            return label;
        }

        // Helper: Tooltip Config
        const tooltipConfig = {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    if (Array.isArray(label)) {
                        return label.join(' ');
                    } else {
                        return label;
                    }
                }
            }
        };

        // 1. Resource Allocation (Doughnut)
        const ctxResource = document.getElementById('resourceChart').getContext('2d');
        const labelsResource = ['Docker Containers', 'Virtual Machines', 'Hypervisor Overhead'];
        new Chart(ctxResource, {
            type: 'doughnut',
            data: {
                labels: labelsResource.map(wrapLabel),
                datasets: [{
                    data: [15, 3, 2], // 15 containers, 3 VMs, 2 units overhead
                    backgroundColor: [
                        '#3b82f6', // Blue
                        '#10b981', // Emerald
                        '#1e293b'  // Dark
                    ],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: tooltipConfig,
                    title: { display: true, text: 'Service Density per Unit of RAM' }
                }
            }
        });

        // 2. Logging Volume (Bar Chart)
        const ctxLogging = document.getElementById('loggingChart').getContext('2d');
        const labelsLogging = ['pfSense Firewall', 'Nginx Proxy', 'Authentication', 'System Events'];
        new Chart(ctxLogging, {
            type: 'bar',
            data: {
                labels: labelsLogging.map(wrapLabel),
                datasets: [{
                    label: 'Daily Log Volume (MB)',
                    data: [450, 120, 50, 80],
                    backgroundColor: '#3b82f6',
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: tooltipConfig
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        // 3. Security Radar (Comparison)
        const ctxRadar = document.getElementById('securityRadar').getContext('2d');
        const labelsRadar = ['Network Visibility', 'Traffic Isolation', 'Access Control', 'Threat Detection', 'Ease of Mgmt'];
        new Chart(ctxRadar, {
            type: 'radar',
            data: {
                labels: labelsRadar.map(wrapLabel),
                datasets: [{
                    label: 'Proposed Architecture',
                    data: [9, 10, 9, 8, 6], // High security, moderate difficulty
                    backgroundColor: 'rgba(16, 185, 129, 0.2)',
                    borderColor: '#10b981',
                    pointBackgroundColor: '#10b981',
                    borderWidth: 2
                }, {
                    label: 'Standard ISP Setup',
                    data: [2, 1, 3, 1, 10], // Low security, high ease of use
                    backgroundColor: 'rgba(148, 163, 184, 0.2)',
                    borderColor: '#94a3b8',
                    pointBackgroundColor: '#94a3b8',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'top' },
                    tooltip: tooltipConfig
                },
                scales: {
                    r: {
                        angleLines: { color: '#e2e8f0' },
                        grid: { color: '#e2e8f0' },
                        suggestedMin: 0,
                        suggestedMax: 10
                    }
                }
            }
        });

    </script>
</body>
</html>